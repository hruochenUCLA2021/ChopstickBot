version: 1

robot:
  name: chopstick_bot

# If you run: `python3 model_generator.py` (no CLI args),
# the generator will read these and write outputs automatically.
output:
  out_dir: /media/hrc/T7_UBUNTU_ONLY/Codesign_ChopstickBot_all_files/ChopstickBot/model_generator_hrc
  urdf_name: chopstick_bot_general.urdf
  mjcf_name: chopstick_bot_general.xml

options:
  floating_base: true
  # Match ChopsticBot config default: no extra joint-frame inertia bodies.
  use_joint_frames: true
  # Keep sensors off for this config by default (can turn on when needed).
  add_sensors: true
  # If true, emit MJCF <actuator> position actuators (so keyframe ctrl has non-zero length).
  add_actuators: true
  # Base pose in MJCF/URDF and in generated scene keyframes.
  base_pose:
    xyz: [0.0, 0.0, 0.33]
    rpy: [0.0, 0.0, 0.0]
  # Joint passive stabilization terms (applied to all hinge joints).
  joint_passive:
    enable: true
    default:
      damping: 0.01
      frictionloss: 0.01
      armature: 0.02
    # Optional: per-motor overrides (one dict per left_leg.motors entry)
    # leg:
    #   - {damping: 0.01, frictionloss: 0.01, armature: 0.02}
    # trunk:
    #   damping: 0.01
    #   frictionloss: 0.01
    #   armature: 0.02

actuators:
  # One [kp, ki, kd] triple per left-leg motor stage (right leg mirrors it).
  leg_pid:
    - [5, 0, 0]   # hip_pitch
    - [5, 0, 0]   # hip_roll
  # Trunk joint PID triple
  trunk_pid: [5, 0, 0]
  ctrlrange: [-3.14159, 3.14159]

scenes:
  # If true, emit `scene_joystick_flat_terrain.xml` and `scene_joystick_rough_terrain.xml`.
  generate: true
  keyframe:
    name: home
    # Optional overrides (otherwise generator fills with zeros):
    # - joint_qpos: [ ... ]   # length = 2*len(left_leg.motors) + 1
    # - ctrl:      [ ... ]    # length = 2*len(left_leg.motors) + 1
  flat:
    filename: scene_joystick_flat_terrain_chopstickbot.xml
    model_name: "chopstickbot scene"
  rough:
    filename: scene_joystick_rough_terrain_chopstickbot.xml
    model_name: "chopstickbot scene"
    texture_file: assets/rocky_texture.png
    hfield_file: assets/hfield.png
    hfield_size: [10, 10, 0.05, 0.1]
    floor_contype: 1
    floor_conaffinity: 2
    floor_condim: 3

sensors:
  imu_site:
    # Base body site used by IMU-like sensors
    name: imu
    xyz: [0.0, 0.0, 0.0]
    # rotate base frame around Z by +90deg so site +X faces robot front
    rpy: [0.0, 0.0, 1.5707963267948966]
  end_effector_sites:
    left_name: left_foot
    right_name: right_foot

assets:
  motor_stl: /media/hrc/T7_UBUNTU_ONLY/Codesign_ChopstickBot_all_files/reference/xm430_motor/good_conversion_stl/XL-430_new_coordinate_on_axis.STL
  motor_mesh_scale: 0.001
  # Make generated URDF/MJCF portable: copy STL into output folder and reference it relatively.
  use_relative_paths: true
  copy_assets_to_output: true
  output_mesh_dir: meshes

components:
  motor:
    mass_kg: 0.065
    size_xyz: [0.0285, 0.0465, 0.034]
    com_offset_xyz: [0.0, -0.012, 0.0]
    visual_rgba: [0.89804, 0.91765, 0.92941, 1.0]
    collision_rgba: [0.0, 0.8, 0.1, 1.0]
    # Default motor shaft axis in motor frame
    joint_axis_xyz: [0.0, 0.0, 1.0]
    # MJCF contact filtering (explicit):
    # Default fast-sim: motor visual mesh and motor box do NOT collide.
    mesh_contype: 0
    mesh_conaffinity: 0
    box_contype: 0
    box_conaffinity: 0

  frame:
    mass_kg: 0.001
    size_xyz: [0.01, 0.01, 0.01]

  trunk:
    mass_kg: 0.20
    size_xyz: [0.05, 0.05, 0.05]
    visual_rgba: [0.7, 0.7, 0.7, 1.0]
    # Optional: if the trunk frame origin is not at its box center/COM
    com_offset_xyz: [0.0, 0.0, 0.0]
    geom_offset_xyz: [0.0, 0.0, 0.0]
    # MJCF contact filtering (explicit): trunk does NOT collide by default.
    geom_contype: 0
    geom_conaffinity: 0

  end_effector:
    # Chopstick leg bar (cylinder)
    mass_kg: 0.03
    visual_rgba: [0.7, 0.7, 0.7, 1.0]
    # Link frame is at the joint; cylinder COM is at its center (shifted down the bar)
    # Put COM and geometry at the end-effector link origin; place the link itself using left_leg.end_effector.xyz/rpy.
    com_offset_xyz: [0.0, 0.0, 0.0]
    geom_offset_xyz: [0.0, 0.0, 0.0]
    # MJCF contact filtering (explicit): end-effector SHOULD collide.
    geom_contype: 1
    geom_conaffinity: 1
    # geom_offset_rpy will be added in generator (rotate cylinder axis Z -> +Y)
    geom_offset_rpy: [1.5707963267948966, 0.0, 0.0]
    shape:
      # Cylinder visual only + collision proxy box at the tip (MJX-friendly).
      type: cylinder_tip_box
      radius: 0.005
      length: 0.20
      # Full box size (MuJoCo uses half-sizes internally).
      tip_box_size_xyz: [0.02, 0.02, 0.02]
      # Tip placement along the cylinder axis in end-effector frame:
      # tip_pos = geom_offset_xyz + axis*(tip_direction*length/2 + tip_offset)
      tip_direction: 1.0
      tip_offset: 0.0

# Trunk attaches as the 3rd branch from the base (after legs are emitted in XML order).
trunk:
  mount:
    xyz: [0.0, 0.0, 0.05]
    rpy: [0.0, 0.0, 0.0]
  joint:
    name: base_to_trunk
    type: hinge
    axis_xyz: [0.0, 0.0, 1.0]

left_leg:
  # ChopstickBot: 2 motors per side (hip_pitch + hip_roll), then a bar end-effector.
  motors:
    - name: hip_pitch
      xyz: [-0.04, 0.0, 0.0]
      rpy: [0.0, -1.5707963267948966, 0.0]
      rotates_with_joint: false
    - name: hip_roll
      xyz: [0.0, 0.0, 0.04]
      rpy: [0.0, -1.5707963267948966, -1.5707963267948966]
      rotates_with_joint: false

  end_effector:
    # hip_roll motor output -> bar link
    # Place the bar link origin at the cylinder center so the top end is at the hip_roll output.
    # Keep the original 17cm placement (center is 17cm down the bar axis).
    xyz: [0.0, -0.17, 0.0]
    rpy: [0.0, 0.0, 0.0]


